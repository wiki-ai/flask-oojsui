/*! OOjs UI v0.19.5 | http://oojs.mit-license.org */
!function(a){"use strict";a.ui.ActionWidget=function(b){b=$.extend({framed:!1},b),a.ui.ActionWidget.parent.call(this,b),a.ui.mixin.PendingElement.call(this,b),this.action=b.action||"",this.modes=b.modes||[],this.width=0,this.height=0,this.$element.addClass("oo-ui-actionWidget")},a.inheritClass(a.ui.ActionWidget,a.ui.ButtonWidget),a.mixinClass(a.ui.ActionWidget,a.ui.mixin.PendingElement),a.ui.ActionWidget.prototype.hasMode=function(a){return this.modes.indexOf(a)!==-1},a.ui.ActionWidget.prototype.getAction=function(){return this.action},a.ui.ActionWidget.prototype.getModes=function(){return this.modes.slice()},a.ui.ActionWidget.prototype.propagateResize=function(){var a,b;return this.isElementAttached()&&(a=this.$element.width(),b=this.$element.height(),a===this.width&&b===this.height||(this.width=a,this.height=b,this.emit("resize"))),this},a.ui.ActionWidget.prototype.setIcon=function(){return a.ui.mixin.IconElement.prototype.setIcon.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.setLabel=function(){return a.ui.mixin.LabelElement.prototype.setLabel.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.setFlags=function(){return a.ui.mixin.FlaggedElement.prototype.setFlags.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.clearFlags=function(){return a.ui.mixin.FlaggedElement.prototype.clearFlags.apply(this,arguments),this.propagateResize(),this},a.ui.ActionWidget.prototype.toggle=function(){return a.ui.ActionWidget.parent.prototype.toggle.apply(this,arguments),this.propagateResize(),this},a.ui.ActionSet=function(b){b=b||{},a.EventEmitter.call(this),this.list=[],this.categories={actions:"getAction",flags:"getFlags",modes:"getModes"},this.categorized={},this.special={},this.others=[],this.organized=!1,this.changing=!1,this.changed=!1},a.mixinClass(a.ui.ActionSet,a.EventEmitter),a.ui.ActionSet.static.specialFlags=["safe","primary"],a.ui.ActionSet.prototype.onActionChange=function(){this.organized=!1,this.changing?this.changed=!0:this.emit("change")},a.ui.ActionSet.prototype.isSpecial=function(a){var b;for(b in this.special)if(a===this.special[b])return!0;return!1},a.ui.ActionSet.prototype.get=function(a){var b,c,d,e,f,g,h,i;if(a){this.organize(),i=[];for(e in this.categorized)if(d=a[e])for(Array.isArray(d)||(d=[d]),b=0,c=d.length;b<c;b++)f=this.categorized[e][d[b]],Array.isArray(f)&&i.push.apply(i,f);for(b=0,c=i.length;b<c;b++)h=i[b],(void 0!==a.visible&&h.isVisible()!==a.visible||void 0!==a.disabled&&h.isDisabled()!==a.disabled)&&(i.splice(b,1),c--,b--);for(b=0,c=i.length;b<c;b++)for(h=i[b],g=i.lastIndexOf(h);g!==b;)i.splice(g,1),c--,g=i.lastIndexOf(h);return i}return this.list.slice()},a.ui.ActionSet.prototype.getSpecial=function(){return this.organize(),$.extend({},this.special)},a.ui.ActionSet.prototype.getOthers=function(){return this.organize(),this.others.slice()},a.ui.ActionSet.prototype.setMode=function(a){var b,c,d;for(this.changing=!0,b=0,c=this.list.length;b<c;b++)d=this.list[b],d.toggle(d.hasMode(a));return this.organized=!1,this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.setAbilities=function(a){var b,c,d,e;for(b=0,c=this.list.length;b<c;b++)e=this.list[b],d=e.getAction(),void 0!==a[d]&&e.setDisabled(!a[d]);return this},a.ui.ActionSet.prototype.forEach=function(a,b){return this.changed=!1,this.changing=!0,this.get(a).forEach(b),this.changing=!1,this.changed&&this.emit("change"),this},a.ui.ActionSet.prototype.add=function(a){var b,c,d;for(this.changing=!0,b=0,c=a.length;b<c;b++)d=a[b],d.connect(this,{click:["emit","click",d],resize:["emit","resize",d],toggle:["onActionChange"]}),this.list.push(d);return this.organized=!1,this.emit("add",a),this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.remove=function(a){var b,c,d,e;for(this.changing=!0,b=0,c=a.length;b<c;b++)e=a[b],d=this.list.indexOf(e),d!==-1&&(e.disconnect(this),this.list.splice(d,1));return this.organized=!1,this.emit("remove",a),this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.clear=function(){var a,b,c,d=this.list.slice();for(this.changing=!0,a=0,b=this.list.length;a<b;a++)c=this.list[a],c.disconnect(this);return this.list=[],this.organized=!1,this.emit("remove",d),this.changing=!1,this.emit("change"),this},a.ui.ActionSet.prototype.organize=function(){var a,b,c,d,e,f,g,h,i,j,k=this.constructor.static.specialFlags;if(!this.organized){for(this.categorized={},this.special={},this.others=[],a=0,b=this.list.length;a<b;a++)if(f=this.list[a],f.isVisible()){for(g in this.categories)for(this.categorized[g]||(this.categorized[g]={}),h=f[this.categories[g]](),Array.isArray(h)||(h=[h]),c=0,d=h.length;c<d;c++)i=h[c],this.categorized[g][i]||(this.categorized[g][i]=[]),this.categorized[g][i].push(f);for(j=!1,c=0,d=k.length;c<d;c++)if(e=k[c],!this.special[e]&&f.hasFlag(e)){this.special[e]=f,j=!0;break}j||this.others.push(f)}this.organized=!0}return this},a.ui.Error=function(b,c){a.isPlainObject(b)&&void 0===c&&(c=b,b=c.message),c=c||{},this.message=b instanceof jQuery?b:String(b),this.recoverable=void 0===c.recoverable||!!c.recoverable,this.warning=!!c.warning},a.initClass(a.ui.Error),a.ui.Error.prototype.isRecoverable=function(){return this.recoverable},a.ui.Error.prototype.isWarning=function(){return this.warning},a.ui.Error.prototype.getMessage=function(){return this.message instanceof jQuery?this.message.clone():$("<div>").text(this.message).contents()},a.ui.Error.prototype.getMessageText=function(){return this.message instanceof jQuery?this.message.text():this.message},a.ui.Process=function(a,b){this.steps=[],void 0!==a&&this.next(a,b)},a.initClass(a.ui.Process),a.ui.Process.prototype.execute=function(){function b(b){return function(){var c,d=b.callback.call(b.context);if(d===!1)return $.Deferred().reject([]).promise();if("number"==typeof d){if(d<0)throw new Error("Cannot go back in time: flux capacitor is out of service");return c=$.Deferred(),setTimeout(c.resolve,d),c.promise()}return d instanceof a.ui.Error?$.Deferred().reject([d]).promise():Array.isArray(d)&&d.length&&d[0]instanceof a.ui.Error?$.Deferred().reject(d).promise():d&&$.isFunction(d.promise)?d.promise():$.Deferred().resolve().promise()}}var c,d,e;if(this.steps.length)for(e=b(this.steps[0])(),c=1,d=this.steps.length;c<d;c++)e=e.then(b(this.steps[c]));else e=$.Deferred().resolve().promise();return e},a.ui.Process.prototype.createStep=function(a,b){if("number"==typeof a||$.isFunction(a.promise))return{callback:function(){return a},context:null};if($.isFunction(a))return{callback:a,context:b};throw new Error("Cannot create process step: number, promise or function expected")},a.ui.Process.prototype.first=function(a,b){return this.steps.unshift(this.createStep(a,b)),this},a.ui.Process.prototype.next=function(a,b){return this.steps.push(this.createStep(a,b)),this},a.ui.WindowManager=function(b){b=b||{},a.ui.WindowManager.parent.call(this,b),a.EventEmitter.call(this),this.factory=b.factory,this.modal=void 0===b.modal||!!b.modal,this.windows={},this.opening=null,this.opened=null,this.closing=null,this.preparingToOpen=null,this.preparingToClose=null,this.currentWindow=null,this.globalEvents=!1,this.$returnFocusTo=null,this.$ariaHidden=null,this.onWindowResizeTimeout=null,this.onWindowResizeHandler=this.onWindowResize.bind(this),this.afterWindowResizeHandler=this.afterWindowResize.bind(this),this.$element.addClass("oo-ui-windowManager").toggleClass("oo-ui-windowManager-modal",this.modal)},a.inheritClass(a.ui.WindowManager,a.ui.Element),a.mixinClass(a.ui.WindowManager,a.EventEmitter),a.ui.WindowManager.static.sizes={small:{width:300},medium:{width:500},large:{width:700},larger:{width:900},full:{width:"100%",height:"100%"}},a.ui.WindowManager.static.defaultSize="medium",a.ui.WindowManager.prototype.onWindowResize=function(){clearTimeout(this.onWindowResizeTimeout),this.onWindowResizeTimeout=setTimeout(this.afterWindowResizeHandler,200)},a.ui.WindowManager.prototype.afterWindowResize=function(){this.currentWindow&&this.updateWindowSize(this.currentWindow)},a.ui.WindowManager.prototype.isOpening=function(a){return a===this.currentWindow&&!!this.opening&&"pending"===this.opening.state()},a.ui.WindowManager.prototype.isClosing=function(a){return a===this.currentWindow&&!!this.closing&&"pending"===this.closing.state()},a.ui.WindowManager.prototype.isOpened=function(a){return a===this.currentWindow&&!!this.opened&&"pending"===this.opened.state()},a.ui.WindowManager.prototype.hasWindow=function(a){var b;for(b in this.windows)if(this.windows[b]===a)return!0;return!1},a.ui.WindowManager.prototype.getSetupDelay=function(){return 0},a.ui.WindowManager.prototype.getReadyDelay=function(){return 0},a.ui.WindowManager.prototype.getHoldDelay=function(){return 0},a.ui.WindowManager.prototype.getTeardownDelay=function(){return this.modal?250:0},a.ui.WindowManager.prototype.getWindow=function(b){var c=$.Deferred(),d=this.windows[b];return d instanceof a.ui.Window?c.resolve(d):this.factory?this.factory.lookup(b)?(d=this.factory.create(b),this.addWindows([d]),c.resolve(d)):c.reject(new a.ui.Error("Cannot auto-instantiate window: symbolic name is unrecognized by the factory")):c.reject(new a.ui.Error("Cannot get unmanaged window: symbolic name unrecognized as a managed window")),c.promise()},a.ui.WindowManager.prototype.getCurrentWindow=function(){return this.currentWindow},a.ui.WindowManager.prototype.openWindow=function(b,c){var d=this,e=$.Deferred();return c=c||{},"string"==typeof b?this.getWindow(b).then(function(a){return d.openWindow(a,c)}):(this.hasWindow(b)?(this.preparingToOpen||this.opening||this.opened)&&e.reject(new a.ui.Error("Cannot open window: another window is opening or open")):e.reject(new a.ui.Error("Cannot open window: window is not attached to manager")),"rejected"!==e.state()&&(this.preparingToOpen=$.when(this.closing),this.preparingToOpen.done(function(){d.modal&&(d.toggleGlobalEvents(!0),d.toggleAriaIsolation(!0)),d.$returnFocusTo=c.$returnFocusTo||$(document.activeElement),d.currentWindow=b,d.opening=e,d.preparingToOpen=null,d.emit("opening",b,e,c),setTimeout(function(){b.setup(c).then(function(){d.updateWindowSize(b),d.opening.notify({state:"setup"}),setTimeout(function(){b.ready(c).then(function(){d.opening.notify({state:"ready"}),d.opening=null,d.opened=$.Deferred(),e.resolve(d.opened.promise(),c)},function(){d.opening=null,d.opened=$.Deferred(),e.reject(),d.closeWindow(b)})},d.getReadyDelay())},function(){d.opening=null,d.opened=$.Deferred(),e.reject(),d.closeWindow(b)})},d.getSetupDelay())})),e.promise())},a.ui.WindowManager.prototype.closeWindow=function(b,c){var d,e=this,f=$.Deferred();return"string"==typeof b?b=this.windows[b]:this.hasWindow(b)||(b=null),b?b!==this.currentWindow?f.reject(new a.ui.Error("Cannot close window: window already closed with different data")):(this.preparingToClose||this.closing)&&f.reject(new a.ui.Error("Cannot close window: window already closing with different data")):f.reject(new a.ui.Error("Cannot close window: window is not attached to manager")),"rejected"!==f.state()&&(this.preparingToClose=$.when(this.opening),this.preparingToClose.always(function(){e.closing=f,e.preparingToClose=null,e.emit("closing",b,f,c),d=e.opened,e.opened=null,d.resolve(f.promise(),c),setTimeout(function(){b.hold(c).then(function(){f.notify({state:"hold"}),setTimeout(function(){b.teardown(c).then(function(){f.notify({state:"teardown"}),e.modal&&(e.toggleGlobalEvents(!1),e.toggleAriaIsolation(!1)),e.$returnFocusTo&&e.$returnFocusTo.length&&e.$returnFocusTo[0].focus(),e.closing=null,e.currentWindow=null,f.resolve(c)})},e.getTeardownDelay())})},e.getHoldDelay())})),f.promise()},a.ui.WindowManager.prototype.addWindows=function(b){var c,d,e,f,g;if(Array.isArray(b))for(g={},c=0,d=b.length;c<d;c++){if(f=b[c].constructor.static.name,!f)throw new Error("Windows must have a `name` static property defined.");g[f]=b[c]}else a.isPlainObject(b)&&(g=b);for(f in g)e=g[f],this.windows[f]=e.toggle(!1),this.$element.append(e.$element),e.setManager(this)},a.ui.WindowManager.prototype.removeWindows=function(a){var b,c,d,e,f,g=this,h=[],i=function(a,b){delete g.windows[a],b.$element.detach()};for(b=0,c=a.length;b<c;b++){if(e=a[b],d=this.windows[e],!d)throw new Error("Cannot remove window");f=i.bind(null,e,d),h.push(this.closeWindow(e).then(f,f))}return $.when.apply($,h)},a.ui.WindowManager.prototype.clearWindows=function(){return this.removeWindows(Object.keys(this.windows))},a.ui.WindowManager.prototype.updateWindowSize=function(a){var b;if(a===this.currentWindow)return b="full"===a.getSize(),this.$element.toggleClass("oo-ui-windowManager-fullscreen",b),this.$element.toggleClass("oo-ui-windowManager-floating",!b),a.setDimensions(a.getSizeProperties()),this.emit("resize",a),this},a.ui.WindowManager.prototype.toggleGlobalEvents=function(a){var b,c,d=$(this.getElementDocument().body),e=d.data("windowManagerGlobalEvents")||0;return a=void 0===a?!!this.globalEvents:!!a,a?this.globalEvents||($(this.getElementWindow()).on({"orientationchange resize":this.onWindowResizeHandler}),0===e&&(b=window.innerWidth-document.documentElement.clientWidth,c=parseFloat(d.css("margin-right"))||0,d.css({overflow:"hidden","margin-right":c+b})),e++,this.globalEvents=!0):this.globalEvents&&($(this.getElementWindow()).off({"orientationchange resize":this.onWindowResizeHandler}),e--,0===e&&d.css({overflow:"","margin-right":""}),this.globalEvents=!1),d.data("windowManagerGlobalEvents",e),this},a.ui.WindowManager.prototype.toggleAriaIsolation=function(a){return a=void 0===a?!this.$ariaHidden:!!a,a?this.$ariaHidden||(this.$ariaHidden=$("body").children().not(this.$element.parentsUntil("body").last()).attr("aria-hidden","")):this.$ariaHidden&&(this.$ariaHidden.removeAttr("aria-hidden"),this.$ariaHidden=null),this},a.ui.WindowManager.prototype.destroy=function(){this.toggleGlobalEvents(!1),this.toggleAriaIsolation(!1),this.clearWindows(),this.$element.remove()},a.ui.Window=function(b){b=b||{},a.ui.Window.parent.call(this,b),a.EventEmitter.call(this),this.manager=null,this.size=b.size||this.constructor.static.size,this.$frame=$("<div>"),this.$overlay=$("<div>"),this.$content=$("<div>"),this.$focusTrapBefore=$("<div>").prop("tabIndex",0),this.$focusTrapAfter=$("<div>").prop("tabIndex",0),this.$focusTraps=this.$focusTrapBefore.add(this.$focusTrapAfter),this.$overlay.addClass("oo-ui-window-overlay"),this.$content.addClass("oo-ui-window-content").attr("tabindex",0),this.$frame.addClass("oo-ui-window-frame").append(this.$focusTrapBefore,this.$content,this.$focusTrapAfter),this.$element.addClass("oo-ui-window").append(this.$frame,this.$overlay),this.visible=!1,this.$element.addClass("oo-ui-element-hidden")},a.inheritClass(a.ui.Window,a.ui.Element),a.mixinClass(a.ui.Window,a.EventEmitter),a.ui.Window.static.size="medium",a.ui.Window.prototype.onMouseDown=function(a){if(a.target===this.$element[0])return!1},a.ui.Window.prototype.isInitialized=function(){return!!this.manager},a.ui.Window.prototype.isVisible=function(){return this.visible},a.ui.Window.prototype.isOpening=function(){return this.manager.isOpening(this)},a.ui.Window.prototype.isClosing=function(){return this.manager.isClosing(this)},a.ui.Window.prototype.isOpened=function(){return this.manager.isOpened(this)},a.ui.Window.prototype.getManager=function(){return this.manager},a.ui.Window.prototype.getSize=function(){var b=a.ui.Element.static.getDimensions(this.getElementWindow()),c=this.manager.constructor.static.sizes,d=this.size;return c[d]||(d=this.manager.constructor.static.defaultSize),"full"!==d&&b.rect.right-b.rect.left<c[d].width&&(d="full"),d},a.ui.Window.prototype.getSizeProperties=function(){return this.manager.constructor.static.sizes[this.getSize()]},a.ui.Window.prototype.withoutSizeTransitions=function(a){var b=this.$frame.css("transition-property")+" "+this.$frame.css("transition-duration")+" "+this.$frame.css("transition-timing-function")+" "+this.$frame.css("transition-delay");this.$frame.css("transition","none"),a(),this.$frame.height(),this.$frame.css("transition",b)},a.ui.Window.prototype.getContentHeight=function(){var a,b=this,c=this.$body[0].style,d=this.$frame[0].style;return this.withoutSizeTransitions(function(){var e=d.height,f=c.position;d.height="1px",c.position="relative",a=b.getBodyHeight(),d.height=e,c.position=f}),this.$frame.outerHeight()-this.$frame.innerHeight()+(this.$head.outerHeight(!0)+a+this.$foot.outerHeight(!0))},a.ui.Window.prototype.getBodyHeight=function(){return this.$body[0].scrollHeight},a.ui.Window.prototype.getDir=function(){return a.ui.Element.static.getDir(this.$content)||"ltr"},a.ui.Window.prototype.getSetupProcess=function(){return new a.ui.Process},a.ui.Window.prototype.getReadyProcess=function(){return new a.ui.Process},a.ui.Window.prototype.getHoldProcess=function(){return new a.ui.Process},a.ui.Window.prototype.getTeardownProcess=function(){return new a.ui.Process},a.ui.Window.prototype.setManager=function(a){if(this.manager)throw new Error("Cannot set window manager, window already has a manager");return this.manager=a,this.initialize(),this},a.ui.Window.prototype.setSize=function(a){return this.size=a,this.updateSize(),this},a.ui.Window.prototype.updateSize=function(){if(!this.manager)throw new Error("Cannot update window size, must be attached to a manager");return this.manager.updateWindowSize(this),this},a.ui.Window.prototype.setDimensions=function(a){var b,c=this,d=this.$frame[0].style;return void 0===a.height?this.withoutSizeTransitions(function(){var e=d.width;c.$frame.css("width",a.width||""),b=c.getContentHeight(),d.width=e}):b=a.height,this.$frame.css({width:a.width||"",minWidth:a.minWidth||"",maxWidth:a.maxWidth||"",height:b||"",minHeight:a.minHeight||"",maxHeight:a.maxHeight||""}),this},a.ui.Window.prototype.initialize=function(){if(!this.manager)throw new Error("Cannot initialize window, must be attached to a manager");return this.$head=$("<div>"),this.$body=$("<div>"),this.$foot=$("<div>"),this.$document=$(this.getElementDocument()),this.$element.on("mousedown",this.onMouseDown.bind(this)),this.$head.addClass("oo-ui-window-head"),this.$body.addClass("oo-ui-window-body"),this.$foot.addClass("oo-ui-window-foot"),this.$content.append(this.$head,this.$body,this.$foot),this},a.ui.Window.prototype.onFocusTrapFocused=function(b){var c=this.$focusTrapBefore.is(b.target),d=a.ui.findFocusable(this.$content,c);d?d.focus():this.$content.focus()},a.ui.Window.prototype.open=function(a){if(!this.manager)throw new Error("Cannot open window, must be attached to a manager");return this.manager.openWindow(this,a)},a.ui.Window.prototype.close=function(a){if(!this.manager)throw new Error("Cannot close window, must be attached to a manager");return this.manager.closeWindow(this,a)},a.ui.Window.prototype.setup=function(b){var c=this;return this.toggle(!0),this.focusTrapHandler=a.ui.bind(this.onFocusTrapFocused,this),this.$focusTraps.on("focus",this.focusTrapHandler),this.getSetupProcess(b).execute().then(function(){c.$element.addClass("oo-ui-window-active oo-ui-window-setup").width(),c.$content.addClass("oo-ui-window-content-setup").width()})},a.ui.Window.prototype.ready=function(a){var b=this;return this.$content.focus(),this.getReadyProcess(a).execute().then(function(){b.$element.addClass("oo-ui-window-ready").width(),b.$content.addClass("oo-ui-window-content-ready").width()})},a.ui.Window.prototype.hold=function(b){var c=this;return this.getHoldProcess(b).execute().then(function(){var b=c.$content.find(a.ui.Element.static.getDocument(c.$content).activeElement);b.length&&b[0].blur(),c.$element.removeClass("oo-ui-window-ready").width(),c.$content.removeClass("oo-ui-window-content-ready").width()})},a.ui.Window.prototype.teardown=function(a){var b=this;return this.getTeardownProcess(a).execute().then(function(){b.$element.removeClass("oo-ui-window-active oo-ui-window-setup").width(),b.$content.removeClass("oo-ui-window-content-setup").width(),b.$focusTraps.off("focus",b.focusTrapHandler),b.toggle(!1)})},a.ui.Dialog=function(b){a.ui.Dialog.parent.call(this,b),a.ui.mixin.PendingElement.call(this),this.actions=new a.ui.ActionSet,this.attachedActions=[],this.currentAction=null,this.onDialogKeyDownHandler=this.onDialogKeyDown.bind(this),this.actions.connect(this,{click:"onActionClick",change:"onActionsChange"}),this.$element.addClass("oo-ui-dialog").attr("role","dialog")},a.inheritClass(a.ui.Dialog,a.ui.Window),a.mixinClass(a.ui.Dialog,a.ui.mixin.PendingElement),a.ui.Dialog.static.name="",a.ui.Dialog.static.title="",a.ui.Dialog.static.actions=[],a.ui.Dialog.static.escapable=!0,a.ui.Dialog.prototype.onDialogKeyDown=function(b){var c;b.which===a.ui.Keys.ESCAPE&&this.constructor.static.escapable?(this.executeAction(""),b.preventDefault(),b.stopPropagation()):b.which===a.ui.Keys.ENTER&&(b.ctrlKey||b.metaKey)&&(c=this.actions.get({flags:"primary",visible:!0,disabled:!1}),c.length>0&&(this.executeAction(c[0].getAction()),b.preventDefault(),b.stopPropagation()))},a.ui.Dialog.prototype.onActionClick=function(a){this.isPending()||this.executeAction(a.getAction())},a.ui.Dialog.prototype.onActionsChange=function(){this.detachActions(),this.isClosing()||this.attachActions()},a.ui.Dialog.prototype.getActions=function(){return this.actions},a.ui.Dialog.prototype.getActionProcess=function(b){return(new a.ui.Process).next(function(){b||this.close()},this)},a.ui.Dialog.prototype.getSetupProcess=function(b){return b=b||{},a.ui.Dialog.parent.prototype.getSetupProcess.call(this,b).next(function(){var a=this.constructor.static,c=void 0!==b.actions?b.actions:a.actions,d=void 0!==b.title?b.title:a.title;this.title.setLabel(d).setTitle(d),this.actions.add(this.getActionWidgets(c)),this.$element.on("keydown",this.onDialogKeyDownHandler)},this)},a.ui.Dialog.prototype.getTeardownProcess=function(b){return a.ui.Dialog.parent.prototype.getTeardownProcess.call(this,b).first(function(){this.$element.off("keydown",this.onDialogKeyDownHandler),this.actions.clear(),this.currentAction=null},this)},a.ui.Dialog.prototype.initialize=function(){var b;a.ui.Dialog.parent.prototype.initialize.call(this),b=a.ui.generateElementId(),this.title=new a.ui.LabelWidget({id:b}),this.$content.addClass("oo-ui-dialog-content"),this.$element.attr("aria-labelledby",b),this.setPendingElement(this.$head)},a.ui.Dialog.prototype.getActionWidgets=function(b){var c,d,e=[];for(c=0,d=b.length;c<d;c++)e.push(new a.ui.ActionWidget(b[c]));return e},a.ui.Dialog.prototype.attachActions=function(){this.attachedActions=this.actions.get()},a.ui.Dialog.prototype.detachActions=function(){var a,b;for(a=0,b=this.attachedActions.length;a<b;a++)this.attachedActions[a].$element.detach();this.attachedActions=[]},a.ui.Dialog.prototype.executeAction=function(a){return this.pushPending(),this.currentAction=a,this.getActionProcess(a).execute().always(this.popPending.bind(this))},a.ui.MessageDialog=function(b){a.ui.MessageDialog.parent.call(this,b),this.verticalActionLayout=null,this.$element.addClass("oo-ui-messageDialog")},a.inheritClass(a.ui.MessageDialog,a.ui.Dialog),a.ui.MessageDialog.static.name="message",a.ui.MessageDialog.static.size="small",a.ui.MessageDialog.static.verbose=!0,a.ui.MessageDialog.static.title=null,a.ui.MessageDialog.static.message=null,a.ui.MessageDialog.static.actions=[{action:"accept",label:a.ui.deferMsg("ooui-dialog-message-accept"),flags:"primary"},{action:"reject",label:a.ui.deferMsg("ooui-dialog-message-reject"),flags:"safe"}],a.ui.MessageDialog.prototype.setManager=function(b){return a.ui.MessageDialog.parent.prototype.setManager.call(this,b),this.manager.connect(this,{resize:"onResize"}),this},a.ui.MessageDialog.prototype.onResize=function(){var a=this;a.fitActions(),setTimeout(function(){a.fitActions()},300)},a.ui.MessageDialog.prototype.toggleVerticalActionLayout=function(a){return a=void 0===a?!this.verticalActionLayout:!!a,a!==this.verticalActionLayout&&(this.verticalActionLayout=a,this.$actions.toggleClass("oo-ui-messageDialog-actions-vertical",a).toggleClass("oo-ui-messageDialog-actions-horizontal",!a)),this},a.ui.MessageDialog.prototype.getActionProcess=function(b){return b?new a.ui.Process(function(){this.close({action:b})},this):a.ui.MessageDialog.parent.prototype.getActionProcess.call(this,b)},a.ui.MessageDialog.prototype.getSetupProcess=function(b){return b=b||{},a.ui.MessageDialog.parent.prototype.getSetupProcess.call(this,b).next(function(){this.title.setLabel(void 0!==b.title?b.title:this.constructor.static.title),this.message.setLabel(void 0!==b.message?b.message:this.constructor.static.message),this.message.$element.toggleClass("oo-ui-messageDialog-message-verbose",void 0!==b.verbose?b.verbose:this.constructor.static.verbose)},this)},a.ui.MessageDialog.prototype.getReadyProcess=function(b){return b=b||{},a.ui.MessageDialog.parent.prototype.getReadyProcess.call(this,b).next(function(){var a=this.actions.get();a=a.filter(function(a){return a.getFlags().indexOf("primary")>-1}),a.length>0&&a[0].$button.focus()},this)},a.ui.MessageDialog.prototype.getBodyHeight=function(){var b,c,d=this.container.$element;return c=d[0].style.overflow,d[0].style.overflow="hidden",a.ui.Element.static.reconsiderScrollbars(d[0]),b=this.text.$element.outerHeight(!0),d[0].style.overflow=c,b},a.ui.MessageDialog.prototype.setDimensions=function(b){var c=this.container.$element;return a.ui.MessageDialog.parent.prototype.setDimensions.call(this,b),setTimeout(function(){var b=c[0].style.overflow,d=document.activeElement;c[0].style.overflow="hidden",a.ui.Element.static.reconsiderScrollbars(c[0]),d&&d!==document.activeElement&&d.focus&&d.focus(),c[0].style.overflow=b},300),this},a.ui.MessageDialog.prototype.initialize=function(){a.ui.MessageDialog.parent.prototype.initialize.call(this),this.$actions=$("<div>"),this.container=new a.ui.PanelLayout({scrollable:!0,classes:["oo-ui-messageDialog-container"]}),this.text=new a.ui.PanelLayout({padded:!0,expanded:!1,classes:["oo-ui-messageDialog-text"]}),this.message=new a.ui.LabelWidget({classes:["oo-ui-messageDialog-message"]}),this.title.$element.addClass("oo-ui-messageDialog-title"),this.$content.addClass("oo-ui-messageDialog-content"),this.container.$element.append(this.text.$element),this.text.$element.append(this.title.$element,this.message.$element),this.$body.append(this.container.$element),this.$actions.addClass("oo-ui-messageDialog-actions"),this.$foot.append(this.$actions)},a.ui.MessageDialog.prototype.attachActions=function(){var b,c,d,e,f;if(a.ui.MessageDialog.parent.prototype.attachActions.call(this),e=this.actions.getSpecial(),f=this.actions.getOthers(),e.safe&&(this.$actions.append(e.safe.$element),e.safe.toggleFramed(!1)),f.length)for(b=0,c=f.length;b<c;b++)d=f[b],this.$actions.append(d.$element),d.toggleFramed(!1);e.primary&&(this.$actions.append(e.primary.$element),e.primary.toggleFramed(!1)),this.isOpening()||this.updateSize()},a.ui.MessageDialog.prototype.fitActions=function(){var a,b,c,d=this.verticalActionLayout,e=this.actions.get();for(this.toggleVerticalActionLayout(!1),a=0,b=e.length;a<b;a++)if(c=e[a],c.$element.innerWidth()<c.$label.outerWidth(!0)){this.toggleVerticalActionLayout(!0);break}this.$body.css("bottom",this.$foot.outerHeight(!0)),this.verticalActionLayout!==d&&this.updateSize()},a.ui.ProcessDialog=function(b){a.ui.ProcessDialog.parent.call(this,b),this.fitOnOpen=!1,this.$element.addClass("oo-ui-processDialog")},a.inheritClass(a.ui.ProcessDialog,a.ui.Dialog),a.ui.ProcessDialog.prototype.onDismissErrorButtonClick=function(){this.hideErrors()},a.ui.ProcessDialog.prototype.onRetryButtonClick=function(){this.hideErrors(),this.executeAction(this.currentAction)},a.ui.ProcessDialog.prototype.initialize=function(){a.ui.ProcessDialog.parent.prototype.initialize.call(this),this.$navigation=$("<div>"),this.$location=$("<div>"),this.$safeActions=$("<div>"),this.$primaryActions=$("<div>"),this.$otherActions=$("<div>"),this.dismissButton=new a.ui.ButtonWidget({label:a.ui.msg("ooui-dialog-process-dismiss")}),this.retryButton=new a.ui.ButtonWidget,this.$errors=$("<div>"),this.$errorsTitle=$("<div>"),this.dismissButton.connect(this,{click:"onDismissErrorButtonClick"}),this.retryButton.connect(this,{click:"onRetryButtonClick"}),this.title.$element.addClass("oo-ui-processDialog-title"),this.$location.append(this.title.$element).addClass("oo-ui-processDialog-location"),this.$safeActions.addClass("oo-ui-processDialog-actions-safe"),this.$primaryActions.addClass("oo-ui-processDialog-actions-primary"),this.$otherActions.addClass("oo-ui-processDialog-actions-other"),this.$errorsTitle.addClass("oo-ui-processDialog-errors-title").text(a.ui.msg("ooui-dialog-process-error")),this.$errors.addClass("oo-ui-processDialog-errors oo-ui-element-hidden").append(this.$errorsTitle,this.dismissButton.$element,this.retryButton.$element),this.$content.addClass("oo-ui-processDialog-content").append(this.$errors),this.$navigation.addClass("oo-ui-processDialog-navigation").append(this.$primaryActions,this.$location,this.$safeActions),this.$head.append(this.$navigation),this.$foot.append(this.$otherActions)},a.ui.ProcessDialog.prototype.getActionWidgets=function(b){var c,d,e,f=a.ui.isMobile(),g=[];for(c=0,d=b.length;c<d;c++)e=$.extend({framed:!a.ui.isMobile()},b[c]),f&&("back"===e.flags||Array.isArray(e.flags)&&e.flags.indexOf("back")!==-1)&&$.extend(e,{icon:"previous",label:""}),g.push(new a.ui.ActionWidget(e));return g},a.ui.ProcessDialog.prototype.attachActions=function(){var b,c,d,e,f;for(a.ui.ProcessDialog.parent.prototype.attachActions.call(this),e=this.actions.getSpecial(),f=this.actions.getOthers(),e.primary&&this.$primaryActions.append(e.primary.$element),b=0,c=f.length;b<c;b++)d=f[b],this.$otherActions.append(d.$element);e.safe&&this.$safeActions.append(e.safe.$element),this.fitLabel(),this.$body.css("bottom",this.$foot.outerHeight(!0))},a.ui.ProcessDialog.prototype.executeAction=function(b){var c=this;return a.ui.ProcessDialog.parent.prototype.executeAction.call(this,b).fail(function(a){c.showErrors(a||[])})},a.ui.ProcessDialog.prototype.setDimensions=function(){a.ui.ProcessDialog.parent.prototype.setDimensions.apply(this,arguments),this.fitLabel()},a.ui.ProcessDialog.prototype.fitLabel=function(){var a,b,c,d,e,f,g,h=this.getSizeProperties();if("number"!=typeof h.width){if(!this.isOpened())return this.isOpening()?void(this.fitOnOpen||(this.manager.opening.done(this.fitLabel.bind(this)),this.fitOnOpen=!0)):void 0;e=this.$head.width()-20}else e=h.width-20;return a=this.$safeActions.is(":visible")?this.$safeActions.width():0,b=this.$primaryActions.is(":visible")?this.$primaryActions.width():0,c=Math.max(a,b),d=this.title.$element.width(),2*c+d<e?f=g=c:"ltr"===this.getDir()?(f=a,g=b):(f=b,g=a),this.$location.css({paddingLeft:f,paddingRight:g}),this},a.ui.ProcessDialog.prototype.showErrors=function(b){var c,d,e,f,g=[],h={},i=!0,j=!1;for(b instanceof a.ui.Error&&(b=[b]),c=0,d=b.length;c<d;c++)b[c].isRecoverable()||(i=!1),b[c].isWarning()&&(j=!0),e=$("<div>").addClass("oo-ui-processDialog-error").append(b[c].getMessage()),g.push(e[0]);this.$errorItems=$(g),i?(h[this.currentAction]=!0,f=this.actions.get({actions:this.currentAction}),f.length&&this.retryButton.clearFlags().setFlags(f[0].getFlags())):(h[this.currentAction]=!1,this.actions.setAbilities(h)),j?this.retryButton.setLabel(a.ui.msg("ooui-dialog-process-continue")):this.retryButton.setLabel(a.ui.msg("ooui-dialog-process-retry")),this.retryButton.toggle(i),this.$errorsTitle.after(this.$errorItems),this.$errors.removeClass("oo-ui-element-hidden").scrollTop(0)},a.ui.ProcessDialog.prototype.hideErrors=function(){this.$errors.addClass("oo-ui-element-hidden"),this.$errorItems&&(this.$errorItems.remove(),this.$errorItems=null)},a.ui.ProcessDialog.prototype.getTeardownProcess=function(b){return a.ui.ProcessDialog.parent.prototype.getTeardownProcess.call(this,b).first(function(){this.hideErrors(),this.fitOnOpen=!1},this)},a.ui.getWindowManager=function(){return a.ui.windowManager||(a.ui.windowManager=new a.ui.WindowManager,$("body").append(a.ui.windowManager.$element),
a.ui.windowManager.addWindows([new a.ui.MessageDialog])),a.ui.windowManager},a.ui.alert=function(b,c){return a.ui.getWindowManager().openWindow("message",$.extend({message:b,actions:[a.ui.MessageDialog.static.actions[0]]},c)).then(function(a){return a.then(function(a){return a.then(function(){return $.Deferred().resolve()})})})},a.ui.confirm=function(b,c){return a.ui.getWindowManager().openWindow("message",$.extend({message:b},c)).then(function(a){return a.then(function(a){return a.then(function(a){return $.Deferred().resolve(!(!a||"accept"!==a.action))})})})},a.ui.prompt=function(b,c){var d=a.ui.getWindowManager(),e=new a.ui.TextInputWidget(c&&c.textInput||{}),f=new a.ui.FieldLayout(e,{align:"top",label:b});return d.openWindow("message",$.extend({message:f.$element},c)).then(function(a){return e.on("enter",function(){d.getCurrentWindow().close({action:"accept"})}),e.focus(),a.then(function(a){return a.then(function(a){return $.Deferred().resolve(a&&"accept"===a.action?e.getValue():null)})})})}}(OO);
//# sourceMappingURL=oojs-ui-windows.min.js.map